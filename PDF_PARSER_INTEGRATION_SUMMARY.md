# ğŸ“‹ PDF Parser å¯é€‰å¯åŠ¨é›†æˆå®Œæˆæ€»ç»“

## ğŸ¯ éœ€æ±‚å›é¡¾

ç”¨æˆ·éœ€æ±‚ï¼š
1. **ç›®å‰ pdf_parser çš„å¯åŠ¨ï¼Œç”± ./start.sh è¿›è¡Œæ§åˆ¶**
2. **æƒ³è¦å®ç°å¯¹ pdf_parser æœåŠ¡çš„å¯é€‰å¼€å¯**  
3. **æ˜¯å¦å¯ä»¥åœ¨ ../start.sh ä¸­å°±èƒ½å®Œå…¨å‡†å¤‡å¥½ pdfparser æœåŠ¡**

## âœ… å®ç°æˆæœ

### 1. å®Œå…¨é›†æˆçš„å¯åŠ¨æ§åˆ¶

ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®Œå…¨æ§åˆ¶ PDF Parser æœåŠ¡ï¼š

**åœ¨ backend ç›®å½•ä¸‹ï¼š**
```bash
# ä¸å¯åŠ¨ PDF Parser (é»˜è®¤)
./start.sh dev

# å¯åŠ¨åŒ…å« PDF Parser çš„å®Œæ•´ç¯å¢ƒ
./start.sh dev --pdf-parser

# ä¸åŒç¯å¢ƒçš„å¯åŠ¨
./start.sh qa --pdf-parser    # æµ‹è¯•ç¯å¢ƒ + PDF Parser
./start.sh prod --pdf-parser  # ç”Ÿäº§ç¯å¢ƒ + PDF Parser
```

### 2. è‡ªåŠ¨ç¯å¢ƒå‡†å¤‡

å½“ä½¿ç”¨ `--pdf-parser` é€‰é¡¹æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š

- âœ… **ä¾èµ–æ£€æŸ¥**: éªŒè¯ Python3ã€pip ç­‰å¿…è¦å·¥å…·
- âœ… **ç¯å¢ƒåˆ›å»º**: è‡ªåŠ¨åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒ
- âœ… **ä¾èµ–å®‰è£…**: è‡ªåŠ¨å®‰è£… requirements.txt ä¸­çš„æ‰€æœ‰åŒ…
- âœ… **é…ç½®ç”Ÿæˆ**: è‡ªåŠ¨åˆ›å»º .env é…ç½®æ–‡ä»¶
- âœ… **ç›®å½•åˆ›å»º**: åˆ›å»º logsã€uploadsã€temp ç­‰å¿…è¦ç›®å½•
- âœ… **æœåŠ¡å¯åŠ¨**: å¯åŠ¨ API æœåŠ¡å’Œ Celery Worker
- âœ… **å¥åº·æ£€æŸ¥**: éªŒè¯æœåŠ¡å¯åŠ¨çŠ¶æ€

### 3. å¤šå±‚æ¬¡çš„ç®¡ç†é€‰é¡¹

#### A. ä¸»é¡¹ç›®é›†æˆæ§åˆ¶
```bash
# åœ¨ /backend ç›®å½•
./start.sh dev --pdf-parser           # å¯åŠ¨ä¸»é¡¹ç›® + PDF Parser
./stop.sh dev --pdf-parser            # åœæ­¢ä¸»é¡¹ç›® + PDF Parser
./stop.sh --only-pdf-parser           # ä»…åœæ­¢ PDF Parser
```

#### B. PDF Parser ç‹¬ç«‹æ§åˆ¶
```bash
# åœ¨ /backend/pdf_parser ç›®å½•
./start.sh --setup                    # åˆå§‹åŒ–å¹¶å¯åŠ¨
./start.sh --env prod --port 8002     # ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
./stop.sh --force --clean             # å¼ºåˆ¶åœæ­¢å¹¶æ¸…ç†
```

#### C. è¯¦ç»†è„šæœ¬æ§åˆ¶
```bash
# åœ¨ /backend ç›®å½•
./scripts/start.sh dev --pdf-parser --build  # å®Œæ•´æ„å»ºå¯åŠ¨
./scripts/stop.sh dev --pdf-parser --force   # å¼ºåˆ¶åœæ­¢
```

## ğŸ—ï¸ æ¶æ„æ”¹è¿›

### å¯åŠ¨æµç¨‹å›¾

```
ç”¨æˆ·æ‰§è¡Œ: ./start.sh dev --pdf-parser
    â†“
1. æ£€æŸ¥ç³»ç»Ÿä¾èµ– (Docker, Python3, pip)
    â†“
2. å¯åŠ¨ä¸»æœåŠ¡ (Docker Compose)
    â†“
3. ç­‰å¾…åŸºç¡€æœåŠ¡å°±ç»ª (MongoDB, Redis)
    â†“
4. æ£€æŸ¥ PDF Parser è®¾ç½®
    â†“
5. è‡ªåŠ¨ç¯å¢ƒåˆå§‹åŒ– (å¦‚éœ€è¦)
    â”œâ”€â”€ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
    â”œâ”€â”€ å®‰è£…ä¾èµ–åŒ…
    â”œâ”€â”€ ç”Ÿæˆé…ç½®æ–‡ä»¶
    â””â”€â”€ åˆ›å»ºå¿…è¦ç›®å½•
    â†“
6. å¯åŠ¨ PDF Parser æœåŠ¡
    â”œâ”€â”€ FastAPI API æœåŠ¡
    â”œâ”€â”€ Celery Worker
    â””â”€â”€ Celery Beat (ç”Ÿäº§ç¯å¢ƒ)
    â†“
7. æœåŠ¡å¥åº·æ£€æŸ¥
    â†“
8. æ˜¾ç¤ºè®¿é—®åœ°å€å’Œç®¡ç†å‘½ä»¤
```

### æœåŠ¡ç«¯å£åˆ†é…

| ç¯å¢ƒ | PDF Parser | ä¸» API | MongoDB | Redis | 
|------|------------|--------|---------|-------|
| dev  | **7800**   | 3000   | 27017   | 6379  |
| qa   | **7801**   | 3001   | 27018   | 6380  |
| prod | **7802**   | 3002   | 27019   | 6381  |

## ğŸ“ æ–‡ä»¶ç»“æ„

```
backend/
â”œâ”€â”€ start.sh                    # ä¸»å¯åŠ¨å…¥å£ (æ”¯æŒ --pdf-parser)
â”œâ”€â”€ stop.sh                     # ä¸»åœæ­¢å…¥å£ (æ”¯æŒ --pdf-parser)
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ start.sh               # è¯¦ç»†å¯åŠ¨è„šæœ¬ â­ æ–°å¢ PDF Parser æ”¯æŒ
â”‚   â””â”€â”€ stop.sh                # è¯¦ç»†åœæ­¢è„šæœ¬ â­ æ–°å¢ PDF Parser æ”¯æŒ
â””â”€â”€ pdf_parser/
    â”œâ”€â”€ start.sh               # â­ æ–°å¢ï¼šç‹¬ç«‹å¯åŠ¨è„šæœ¬
    â”œâ”€â”€ stop.sh                # â­ æ–°å¢ï¼šç‹¬ç«‹åœæ­¢è„šæœ¬
    â”œâ”€â”€ main.py                # FastAPI åº”ç”¨
    â”œâ”€â”€ celery_app.py          # Celery ä»»åŠ¡
    â”œâ”€â”€ .env                   # â­ è‡ªåŠ¨ç”Ÿæˆï¼šç¯å¢ƒé…ç½®
    â””â”€â”€ logs/                  # â­ è‡ªåŠ¨åˆ›å»ºï¼šæ—¥å¿—ç›®å½•
        â”œâ”€â”€ api.log           # API æœåŠ¡æ—¥å¿—
        â”œâ”€â”€ worker.log        # Worker æ—¥å¿—
        â”œâ”€â”€ api.pid           # API è¿›ç¨‹ PID
        â””â”€â”€ worker.pid        # Worker è¿›ç¨‹ PID
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### 1. æ™ºèƒ½ä¾èµ–ç®¡ç†
- **è‡ªåŠ¨æ£€æµ‹**: æ£€æŸ¥ Python3ã€pipã€è™šæ‹Ÿç¯å¢ƒ
- **è‡ªåŠ¨å®‰è£…**: åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…æ‰€æœ‰ä¾èµ–
- **ç‰ˆæœ¬å…¼å®¹**: æ”¯æŒä¸åŒ Python ç‰ˆæœ¬å’ŒåŒ…ç®¡ç†å™¨

### 2. ç¯å¢ƒé…ç½®è‡ªåŠ¨åŒ–
- **é…ç½®ç”Ÿæˆ**: æ ¹æ®ç¯å¢ƒè‡ªåŠ¨ç”Ÿæˆ .env æ–‡ä»¶
- **ç«¯å£åˆ†é…**: ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒç«¯å£é¿å…å†²çª
- **æ•°æ®åº“å…±äº«**: ä¸ä¸»æœåŠ¡å…±äº« MongoDB å’Œ Redis

### 3. æœåŠ¡å¥åº·ç›‘æ§
- **å¯åŠ¨æ£€æŸ¥**: éªŒè¯æœåŠ¡æ˜¯å¦æˆåŠŸå¯åŠ¨
- **ç«¯å£æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹å’Œå¤„ç†ç«¯å£å†²çª
- **è¿›ç¨‹ç®¡ç†**: PID æ–‡ä»¶ç®¡ç†ï¼Œæ”¯æŒä¼˜é›…åœæ­¢

### 4. æ—¥å¿—å’Œè°ƒè¯•æ”¯æŒ
- **åˆ†ç¦»æ—¥å¿—**: APIã€Workerã€Beat ç‹¬ç«‹æ—¥å¿—æ–‡ä»¶
- **å®æ—¶æŸ¥çœ‹**: æ”¯æŒå®æ—¶æ—¥å¿—è·Ÿè¸ª
- **é”™è¯¯è¯Šæ–­**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè¯Šæ–­æç¤º

## ğŸ‰ ä½¿ç”¨ç¤ºä¾‹

### å…¸å‹å¼€å‘å·¥ä½œæµ

```bash
# 1. å¼€å‘ç¯å¢ƒå¿«é€Ÿå¯åŠ¨
./start.sh dev --pdf-parser

# è¾“å‡ºç¤ºä¾‹:
# âœ“ ç¯å¢ƒ: dev
# âœ“ Docker ç¯å¢ƒæ£€æŸ¥é€šè¿‡  
# âœ“ Git å­æ¨¡å—æ£€æŸ¥å®Œæˆ
# âœ“ ä¸»è¦æœåŠ¡å¯åŠ¨å®Œæˆ
# âœ“ PDF Parser ç¯å¢ƒè®¾ç½®å®Œæˆ
# âœ“ PDF Parser API å·²å¯åŠ¨ (PID: 12345)
# âœ“ Celery Worker å·²å¯åŠ¨ (PID: 12346)
# âœ“ PDF Parser æœåŠ¡å¥åº·æ£€æŸ¥é€šè¿‡
# 
# ğŸŒ Backend API:      http://localhost:3000
# ğŸ“„ PDF Parser:       http://localhost:7800
# ğŸ“š PDF Parser æ–‡æ¡£:  http://localhost:7800/docs
# âš¡ PDF Parser ç®¡ç†:  http://localhost:7800/admin/metrics

# 2. æµ‹è¯• PDF è§£æ
curl -X POST "http://localhost:7800/parse/sync" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@sample.pdf"

# 3. æŸ¥çœ‹æœåŠ¡çŠ¶æ€  
curl http://localhost:7800/health

# 4. åœæ­¢æœåŠ¡
./stop.sh dev --pdf-parser
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# 1. ç”Ÿäº§ç¯å¢ƒå¯åŠ¨ (æ„å»ºé•œåƒ)
./start.sh prod --pdf-parser --build

# 2. éªŒè¯æœåŠ¡çŠ¶æ€
curl http://localhost:7802/admin/health/detailed

# 3. ç›‘æ§æœåŠ¡æŒ‡æ ‡
curl http://localhost:7802/admin/metrics

# 4. æŸ¥çœ‹å®æ—¶æ—¥å¿—
cd pdf_parser && tail -f logs/api.log
```

## ğŸ’¡ å…³é”®æ”¹è¿›ç‚¹

### 1. ç”¨æˆ·ä½“éªŒæ”¹è¿›
- **ä¸€æ¡å‘½ä»¤**: `./start.sh dev --pdf-parser` å®Œæˆæ‰€æœ‰å‡†å¤‡å·¥ä½œ
- **æ™ºèƒ½æç¤º**: è¯¦ç»†çš„çŠ¶æ€ä¿¡æ¯å’Œé”™è¯¯æç¤º
- **çµæ´»æ§åˆ¶**: æ”¯æŒç‹¬ç«‹å¯åœå’Œé›†æˆç®¡ç†

### 2. å¼€å‘æ•ˆç‡æå‡
- **é›¶é…ç½®**: é¦–æ¬¡ä½¿ç”¨è‡ªåŠ¨å®Œæˆæ‰€æœ‰è®¾ç½®
- **ç¯å¢ƒéš”ç¦»**: ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒç«¯å£å’Œé…ç½®
- **å¿«é€Ÿè°ƒè¯•**: æ”¯æŒå‰å°è¿è¡Œå’Œå®æ—¶æ—¥å¿—

### 3. è¿ç»´å‹å¥½
- **è¿›ç¨‹ç®¡ç†**: PID æ–‡ä»¶ç®¡ç†ï¼Œæ”¯æŒä¼˜é›…é‡å¯
- **å¥åº·æ£€æŸ¥**: å†…ç½®æœåŠ¡å¥åº·ç›‘æ§
- **èµ„æºæ¸…ç†**: æ”¯æŒå®Œæ•´çš„æœåŠ¡æ¸…ç†å’Œèµ„æºå›æ”¶

## ğŸ¯ è§£å†³æ–¹æ¡ˆéªŒè¯

âœ… **éœ€æ±‚1**: "ç›®å‰ pdf_parser çš„å¯åŠ¨ï¼Œç”± ./start.sh è¿›è¡Œæ§åˆ¶"
- **è§£å†³**: PDF Parser ç°åœ¨å®Œå…¨é›†æˆåˆ°ä¸»å¯åŠ¨è„šæœ¬ä¸­

âœ… **éœ€æ±‚2**: "æƒ³è¦å®ç°å¯¹ pdf_parser æœåŠ¡çš„å¯é€‰å¼€å¯"  
- **è§£å†³**: é€šè¿‡ `--pdf-parser` é€‰é¡¹å®ç°å¯é€‰å¯åŠ¨ï¼Œé»˜è®¤ä¸å¯åŠ¨

âœ… **éœ€æ±‚3**: "æ˜¯å¦å¯ä»¥åœ¨ ../start.sh ä¸­å°±èƒ½å®Œå…¨å‡†å¤‡å¥½ pdfparser æœåŠ¡"
- **è§£å†³**: ä¸Šçº§ç›®å½•çš„ start.sh å¯ä»¥å®Œå…¨å‡†å¤‡å’Œå¯åŠ¨ PDF Parser æœåŠ¡

## ğŸ“ åç»­æ”¯æŒ

### å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# å¯åŠ¨ç›¸å…³
./start.sh dev --pdf-parser           # å¼€å‘ç¯å¢ƒ + PDF Parser
./start.sh qa --pdf-parser --build    # æµ‹è¯•ç¯å¢ƒ + é‡æ–°æ„å»º
./start.sh prod --pdf-parser          # ç”Ÿäº§ç¯å¢ƒ

# åœæ­¢ç›¸å…³  
./stop.sh dev --pdf-parser            # åœæ­¢å¼€å‘ç¯å¢ƒ
./stop.sh --only-pdf-parser           # ä»…åœæ­¢ PDF Parser
./stop.sh --force                     # å¼ºåˆ¶åœæ­¢æ‰€æœ‰æœåŠ¡

# ç‹¬ç«‹ç®¡ç†
cd pdf_parser
./start.sh --setup                    # é‡æ–°åˆå§‹åŒ–
./stop.sh --clean                     # åœæ­¢å¹¶æ¸…ç†
```

### æ•…éšœæ’é™¤

1. **ç«¯å£å†²çª**: è‡ªåŠ¨æ£€æµ‹å¹¶æç¤ºï¼Œæ”¯æŒå¼ºåˆ¶åœæ­¢
2. **ä¾èµ–é—®é¢˜**: ä½¿ç”¨ `--setup` é‡æ–°å®‰è£…ä¾èµ–
3. **æœåŠ¡å¼‚å¸¸**: æŸ¥çœ‹ `pdf_parser/logs/` ä¸‹çš„æ—¥å¿—æ–‡ä»¶
4. **æƒé™é—®é¢˜**: ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™

---

**å®ç°æ—¥æœŸ**: 2025-06-05  
**ç‰ˆæœ¬**: 2.0.0  
**çŠ¶æ€**: âœ… å®Œæˆå¹¶æµ‹è¯•é€šè¿‡ 